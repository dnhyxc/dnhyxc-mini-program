"use strict";const t=require("../common/vendor.js"),i=require("../server/index.js"),e=require("../constant/index.js"),a=t.defineStore("article",{state:()=>({pageNo:0,pageSize:20,total:0,loading:!1,articleList:[],detail:{},detailLoading:!1,html:""}),actions:{init(){this.pageNo=0,this.pageSize=20,this.total=0,this.articleList=[]},async getArticleList(t){try{if(0!==this.articleList.length&&this.articleList.length>=this.total)return;this.pageNo=this.pageNo+1,this.loading=!0;const a=await i.request({url:`${e.apiUrl}/articleList`,data:{filter:t,pageNo:this.pageNo,pageSize:this.pageSize}});this.loading=!1,(null==a?void 0:a.success)&&(this.total=a.data.total,this.articleList=[...this.articleList,...a.data.list])}catch{this.loading=!1}},async getDetail(a){try{this.detailLoading=!0;const s=await i.request({url:`${e.apiUrl}/articleDetail`,data:{id:a}});if(s.success){this.detail=s.data;const a=await i.request({url:`${e.apiUrl}/md2html`,data:{content:s.data.content,options:{needKatex:!1,lineNumber:!0}}});if(a.success){const i=t.sanitizeHtml(a.data,{allowedTags:!1,transformTags:{iframe:"div",script:"p"},allowedAttributes:!1,allowVulnerableTags:!0});this.detailLoading=!1,this.html=i}else this.html=""}}catch{this.detailLoading=!1}}},getters:{}});exports.useArticleStore=a;
