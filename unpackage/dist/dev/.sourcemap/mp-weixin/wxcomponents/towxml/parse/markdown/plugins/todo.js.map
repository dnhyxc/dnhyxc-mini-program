{"version":3,"file":"todo.js","sources":["wxcomponents/towxml/parse/markdown/plugins/todo.js"],"sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.markdownitTaskLists = f()}})(function(){var define,module,exports;return (function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){\n    // Markdown-it plugin to render GitHub-style task lists; see\n    //\n    // https://github.com/blog/1375-task-lists-in-gfm-issues-pulls-comments\n    // https://github.com/blog/1825-task-lists-in-all-markdown-documents\n    \n    var disableCheckboxes = true;\n    var useLabelWrapper = false;\n    var useLabelAfter = false;\n    \n    module.exports = function(md, options) {\n        if (options) {\n            disableCheckboxes = !options.enabled;\n            useLabelWrapper = !!options.label;\n            useLabelAfter = !!options.labelAfter;\n        }\n    \n        md.core.ruler.after('inline', 'github-task-lists', function(state) {\n            var tokens = state.tokens;\n\n            // 用于寻找关闭标签的数组\n            let tagPaired = (index)=>{\n                let targetItem,\n                    item = tokens[index],\n                    tag = item.tag,\n                    level = item.level,\n                    targetType = item.type === 'list_item_open' ? 'list_item_close' : 'bullet_list_close';\n                for(let i = index,len=tokens.length; i<len; i++){\n                    let _item = tokens[i];\n\n                    if(_item.tag === tag && level === _item.level && _item.type === targetType){\n                        targetItem = _item;\n                        break;\n                    };\n                };\n                return targetItem;\n\n            };\n\n            for (var i = 2; i < tokens.length; i++) {\n                if (isTodoItem(tokens, i)) {\n                    todoify(tokens[i], state.Token);\n                    attrSet(tokens[i-2], 'class', 'task-list-item' + (!disableCheckboxes ? ' enabled' : ''));\n                    attrSet(tokens[parentToken(tokens, i-2)], 'class', 'contains-task-list');\n\n                    tagPaired(parentToken(tokens, i-2)).tag = 'todogroup';\n                    tokens[parentToken(tokens, i-2)].tag = 'todogroup';\n\n                    tagPaired(i-2).tag = 'todolist';\n                    tokens[i-2].tag = 'todolist';\n                };\n            };\n        });\n    };\n    \n    function attrSet(token, name, value) {\n        var index = token.attrIndex(name);\n        var attr = [name, value];\n    \n        if (index < 0) {\n            token.attrPush(attr);\n        } else {\n            token.attrs[index] = attr;\n        }\n    }\n    \n    function parentToken(tokens, index) {\n        var targetLevel = tokens[index].level - 1;\n        for (var i = index - 1; i >= 0; i--) {\n            if (tokens[i].level === targetLevel) {\n                return i;\n            }\n        }\n        return -1;\n    }\n    \n    function isTodoItem(tokens, index) {\n        return isInline(tokens[index]) &&\n               isParagraph(tokens[index - 1]) &&\n               isListItem(tokens[index - 2]) &&\n               startsWithTodoMarkdown(tokens[index]);\n    }\n    \n    function todoify(token, TokenConstructor) {\n        token.children.unshift(makeCheckbox(token, TokenConstructor));\n        token.children[1].content = token.children[1].content.slice(3);\n        token.content = token.content.slice(3);\n    \n        if (useLabelWrapper) {\n            if (useLabelAfter) {\n                token.children.pop();\n    \n                // Use large random number as id property of the checkbox.\n                var id = 'task-item-' + Math.ceil(Math.random() * (10000 * 1000) - 1000);\n                token.children[0].content = token.children[0].content.slice(0, -1) + ' id=\"' + id + '\">';\n                token.children.push(afterLabel(token.content, id, TokenConstructor));\n            } else {\n                token.children.unshift(beginLabel(TokenConstructor));\n                token.children.push(endLabel(TokenConstructor));\n            }\n        }\n    }\n    \n    function makeCheckbox(token, TokenConstructor) {\n        var checkbox = new TokenConstructor('html_inline', '', 0);\n        var disabledAttr = disableCheckboxes ? ' disabled=\"\" ' : '';\n        var value = ' value=\"' + token.content + '\" ';\n        if (token.content.indexOf('[ ] ') === 0) {\n            checkbox.content = '<checkbox class=\"h2w__todoCheckbox task-list-item-checkbox\"' + disabledAttr + value + '/>';\n        } else if (token.content.indexOf('[x] ') === 0 || token.content.indexOf('[X] ') === 0) {\n            checkbox.content = '<checkbox class=\"h2w__todoCheckbox task-list-item-checkbox\" checked=\"true\"' + disabledAttr + value + '/>';\n        }\n        return checkbox;\n    }\n    \n    // these next two functions are kind of hacky; probably should really be a\n    // true block-level token with .tag=='label'\n    function beginLabel(TokenConstructor) {\n        var token = new TokenConstructor('html_inline', '', 0);\n        token.content = '<label>';\n        return token;\n    }\n    \n    function endLabel(TokenConstructor) {\n        var token = new TokenConstructor('html_inline', '', 0);\n        token.content = '</label>';\n        return token;\n    }\n    \n    function afterLabel(content, id, TokenConstructor) {\n        var token = new TokenConstructor('html_inline', '', 0);\n        token.content = '<label class=\"task-list-item-label\" for=\"' + id + '\">' + content + '</label>';\n        token.attrs = [{for: id}];\n        return token;\n    }\n    \n    function isInline(token) { return token.type === 'inline'; }\n    function isParagraph(token) { return token.type === 'paragraph_open'; }\n    function isListItem(token) { return token.type === 'list_item_open'; }\n    \n    function startsWithTodoMarkdown(token) {\n        // leading whitespace in a list item is already trimmed off by markdown-it\n        return token.content.indexOf('[ ] ') === 0 || token.content.indexOf('[x] ') === 0 || token.content.indexOf('[X] ') === 0;\n    }\n    \n    },{}]},{},[1])(1)\n    });"],"names":["module","o","require","e","n","exports","i"],"mappings":"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"}