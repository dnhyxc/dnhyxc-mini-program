{"version":3,"file":"index.js","sources":["wxcomponents/towxml/parse/markdown/index.js"],"sourcesContent":["let hljs;\nhljs = require('../highlight/index');\n\nconst config = require('../../config'),\n    mdOption = (()=>{\n        let result = {\n            html: true,\n            xhtmlOut: true,\n            typographer: true,\n            breaks: true,\n        };\n\n        if(config.highlight.length && hljs){\n            result.highlight = (code,lang,callback)=>{\n                let lineLen = code.split(/\\r|\\n/ig).length,\n                    result = hljs.highlightAuto(code).value;\n\n                    // 代码块多换行的问题\n                    result = result.replace(/(\\r|\\n){2,}/g, str => {\n                        return new Array(str.length).join(\"<p>&nbsp;</p>\")\n                    });\n                    result = result.replace(/\\r|\\n/g, str => {\n                        return \"<br/>\"\n                    });\n\n                    // 代码空格处理\n                    result = result.replace(/>[^<]+</g,str => {\n                        return str.replace(/\\s/g,\"&nbsp;\");\n                    }).replace(/\\t/g,new Array(4).join(\"&nbsp;\"));\n\n                if(config.showLineNumber){\n                    let lineStr = (()=>{\n                        let str = `<ul class=\"h2w__lineNum\">`;\n                        for(let i=0;i<lineLen-1;i++){\n                            str += `<li class=\"h2w__lineNumLine\">${i+1}</li>`\n                        };\n\n                        str += `</ul>`;\n                        return str;\n                    })();\n                    return lineStr + result;\n                };\n                return result;\n            }\n        };\n        return result;\n    })(),\n    md = require('./markdown')(mdOption);\n\n// 应用Markdown解析扩展，包括自定义组件（['sub','sup','ins','mark','emoji','todo','latex','yuml','echarts']）\n// [...config.markdown,...config.components].forEach(item => {\n//     if(!/^audio-player|table|todogroup|img$/.test(item)){\n//         md.use(require(`./plugins/${item}`));\n//     };\n// });\nmd.use(require('./plugins/sub'));md.use(require('./plugins/sup'));md.use(require('./plugins/ins'));md.use(require('./plugins/mark'));md.use(require('./plugins/emoji'));md.use(require('./plugins/todo'));md.use(require('./plugins/latex'));md.use(require('./plugins/yuml'));\n\n// 定义emoji渲染规则\nmd.renderer.rules.emoji = (token,index)=>{\n    let item = token[index];\n    return `<g-emoji class=\"h2w__emoji h2w__emoji--${item.markup}\">${item.content}</g-emoji>`;\n};\n\n// 导出模块\nmodule.exports = str => {\n    return md.render(str);\n};"],"names":["require$$0","require$$1","result","require$$2","require$$3","require$$4","require$$5","require$$6","require$$7","require$$8","require$$9","require$$10"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,MAAI;AACJ,SAAOA,0CAA6B,iBAAA;AAEpC,QAAM,SAASC,2BAAAA,cAAuB,GAClC,YAAY,MAAI;AACZ,QAAI,SAAS;AAAA,MACT,MAAM;AAAA,MACN,UAAU;AAAA,MACV,aAAa;AAAA,MACb,QAAQ;AAAA;AAGZ,QAAG,OAAO,UAAU,UAAU,MAAK;AAC/B,aAAO,YAAY,CAAC,MAAK,MAAK,aAAW;AACrC,YAAI,UAAU,KAAK,MAAM,SAAS,EAAE,QAChCC,UAAS,KAAK,cAAc,IAAI,EAAE;AAGlC,QAAAA,UAASA,QAAO,QAAQ,gBAAgB,SAAO;AAC3C,iBAAO,IAAI,MAAM,IAAI,MAAM,EAAE,KAAK,eAAe;AAAA,QACzE,CAAqB;AACD,QAAAA,UAASA,QAAO,QAAQ,UAAU,SAAO;AACrC,iBAAO;AAAA,QAC/B,CAAqB;AAGD,QAAAA,UAASA,QAAO,QAAQ,YAAW,SAAO;AACtC,iBAAO,IAAI,QAAQ,OAAM,QAAQ;AAAA,QACzD,CAAqB,EAAE,QAAQ,OAAM,IAAI,MAAM,CAAC,EAAE,KAAK,QAAQ,CAAC;AAEhD,YAAG,OAAO,gBAAe;AACrB,cAAI,WAAW,MAAI;AACf,gBAAI,MAAM;AACV,qBAAQ,IAAE,GAAE,IAAE,UAAQ,GAAE,KAAI;AACxB,qBAAO,gCAAgC,IAAE,CAAC;AAAA;AAG9C,mBAAO;AACP,mBAAO;AAAA,UAC/B;AACoB,iBAAO,UAAUA;AAAA,QAErC;AAAgB,eAAOA;AAAA,MACvB;AAAA,IAEA;AAAQ,WAAO;AAAA,EACf,GAAQ,GACJ,KAAKC,4CAAAA,kBAAsB,QAAQ;AAQvC,KAAG,IAAIC,+CAAwB,WAAA,CAAA;AAAE,KAAG,IAAIC,+CAAwB,WAAA,CAAA;AAAE,KAAG,IAAIC,+CAAwB,WAAA,CAAA;AAAE,KAAG,IAAIC,4DAAyB,CAAA;AAAE,KAAG,IAAIC,iDAAAA,aAA0B,CAAA;AAAE,KAAG,IAAIC,gDAAAA,aAAyB;AAAE,KAAG,IAAIC,iDAA0B,aAAA,CAAA;AAAE,KAAG,IAAIC,gDAAA,YAAA,CAAyB;AAG7Q,KAAG,SAAS,MAAM,QAAQ,CAAC,OAAM,UAAQ;AACrC,QAAI,OAAO,MAAM,KAAK;AACtB,WAAO,0CAA0C,KAAK,MAAM,KAAK,KAAK,OAAO;AAAA;AAInE,aAAG,SAAO;AACpB,WAAO,GAAG,OAAO,GAAG;AAAA;;;;"}